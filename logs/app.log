{"timestamp": "2026-01-12T18:14:07.638354Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "__init__", "line": 37, "message": "ChatSessionManager initialized - max_tokens=10240, auto_save_interval=5min", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.679817Z", "level": "INFO", "logger": "app_logger", "module": "context_offloader", "function": "__init__", "line": 33, "message": "InMemoryContextOffloader initialized - chunk_size=100", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.681723Z", "level": "INFO", "logger": "app_logger", "module": "checkpointer", "function": "__init__", "line": 16, "message": "AsyncWindowedCheckpointer initialized with window_size=10", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.681777Z", "level": "INFO", "logger": "app_logger", "module": "checkpointer", "function": "__init__", "line": 76, "message": "AsyncAdaptiveWindowedCheckpointer initialized - base_window=10, max_tokens=8000", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.681817Z", "level": "INFO", "logger": "app_logger", "module": "graph", "function": "create_agent_graph", "line": 57, "message": "agent_graph_created - checkpointer=async_adaptive, window_size=10, max_tokens=1024", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.685047Z", "level": "INFO", "logger": "app_logger", "module": "graph", "function": "create_agent_graph", "line": 70, "message": "agent_graph_compiled_with_async_checkpointing", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.691188Z", "level": "INFO", "logger": "app_logger", "module": "rate_limiter", "function": "__init__", "line": 33, "message": "InMemoryRateLimiter initialized", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:07.703300Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "<module>", "line": 297, "message": "Starting Vendor HelpDesk Agent API server (Production Mode)...", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.021692Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "__init__", "line": 37, "message": "ChatSessionManager initialized - max_tokens=10240, auto_save_interval=5min", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.052058Z", "level": "INFO", "logger": "app_logger", "module": "context_offloader", "function": "__init__", "line": 33, "message": "InMemoryContextOffloader initialized - chunk_size=100", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.053665Z", "level": "INFO", "logger": "app_logger", "module": "checkpointer", "function": "__init__", "line": 16, "message": "AsyncWindowedCheckpointer initialized with window_size=10", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.053718Z", "level": "INFO", "logger": "app_logger", "module": "checkpointer", "function": "__init__", "line": 76, "message": "AsyncAdaptiveWindowedCheckpointer initialized - base_window=10, max_tokens=8000", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.053761Z", "level": "INFO", "logger": "app_logger", "module": "graph", "function": "create_agent_graph", "line": 57, "message": "agent_graph_created - checkpointer=async_adaptive, window_size=10, max_tokens=1024", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.056418Z", "level": "INFO", "logger": "app_logger", "module": "graph", "function": "create_agent_graph", "line": 70, "message": "agent_graph_compiled_with_async_checkpointing", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.060630Z", "level": "INFO", "logger": "app_logger", "module": "rate_limiter", "function": "__init__", "line": 33, "message": "InMemoryRateLimiter initialized", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:08.086556Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "startup_event", "line": 271, "message": "app_startup - version=2.0.0, llm_model=openai/gpt-oss-120b, checkpoint_window=10, auto_save_interval=5min, metrics_enabled=True", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:44.284014Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/auth/login, trace_id=fb0d905f-d97d-4258-b3ef-961fcb3b37ea, request_id=c25991cd-78a1-44cf-807f-bdac2a5b8c0d", "trace_id": "fb0d905f-d97d-4258-b3ef-961fcb3b37ea", "request_id": "c25991cd-78a1-44cf-807f-bdac2a5b8c0d", "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:44.284195Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/auth/login, remaining=4", "trace_id": "fb0d905f-d97d-4258-b3ef-961fcb3b37ea", "request_id": "c25991cd-78a1-44cf-807f-bdac2a5b8c0d", "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:45.560910Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "get_access_token", "line": 51, "message": "auth_success - email=vikram.dev@pwc.com, uid=752110e1-4280-4bab-a935-2013305ed39b, trace_id=96016918-1a3d-469c-b05a-8d25fe8fd468", "trace_id": "96016918-1a3d-469c-b05a-8d25fe8fd468", "request_id": "9d2ca8ee-fbc1-4201-8a41-feaefce70809", "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:45.561200Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/auth/login, status=200, duration_ms=1277.31, trace_id=fb0d905f-d97d-4258-b3ef-961fcb3b37ea", "trace_id": "fb0d905f-d97d-4258-b3ef-961fcb3b37ea", "request_id": "c25991cd-78a1-44cf-807f-bdac2a5b8c0d", "user_id_hash": null}
{"timestamp": "2026-01-12T18:14:45.563469Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/history, trace_id=d709c2d8-b77a-4890-accd-85a667ca0bea, request_id=9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "trace_id": "d709c2d8-b77a-4890-accd-85a667ca0bea", "request_id": "9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:45.563547Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/history, remaining=99", "trace_id": "d709c2d8-b77a-4890-accd-85a667ca0bea", "request_id": "9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.230611Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "81993c31-f7f2-4d0c-83bd-ecc37b2fbe8c", "request_id": "9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "95d04ea0799f4b08", "execution_time_ms": 666.5990352630615, "row_count": 27, "query_preview": "\n        SELECT \n            c.chat_id,\n            c.topic,\n            c.total_tokens,\n           "}}
{"timestamp": "2026-01-12T18:14:46.231337Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=27, total_time=667.45ms", "trace_id": "81993c31-f7f2-4d0c-83bd-ecc37b2fbe8c", "request_id": "9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.231429Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "load_chat_history", "line": 484, "message": "chat_history_loaded - user_id=752110e1..., count=27", "trace_id": "81993c31-f7f2-4d0c-83bd-ecc37b2fbe8c", "request_id": "9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.231777Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/history, status=200, duration_ms=668.39, trace_id=d709c2d8-b77a-4890-accd-85a667ca0bea", "trace_id": "d709c2d8-b77a-4890-accd-85a667ca0bea", "request_id": "9deb8fcd-0eb0-4c70-9e18-cc85eb024ac7", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.233523Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=d6d8239e-5812-4c87-aad6-3c5c99db186e, request_id=c8b70937-97f8-498e-82a1-e8d4c9665125", "trace_id": "d6d8239e-5812-4c87-aad6-3c5c99db186e", "request_id": "c8b70937-97f8-498e-82a1-e8d4c9665125", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.233614Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=99", "trace_id": "d6d8239e-5812-4c87-aad6-3c5c99db186e", "request_id": "c8b70937-97f8-498e-82a1-e8d4c9665125", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.756422Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "83189e92-9924-487b-a59a-219f23a5feaf", "request_id": "c8b70937-97f8-498e-82a1-e8d4c9665125", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 522.3910808563232, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:14:46.756734Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=522.82ms", "trace_id": "83189e92-9924-487b-a59a-219f23a5feaf", "request_id": "c8b70937-97f8-498e-82a1-e8d4c9665125", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.758823Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "83189e92-9924-487b-a59a-219f23a5feaf", "request_id": "c8b70937-97f8-498e-82a1-e8d4c9665125", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:14:46.759567Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=526.11, trace_id=d6d8239e-5812-4c87-aad6-3c5c99db186e", "trace_id": "d6d8239e-5812-4c87-aad6-3c5c99db186e", "request_id": "c8b70937-97f8-498e-82a1-e8d4c9665125", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.770784Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=f16970d3-f662-4eab-992b-bc3f40c3a761, request_id=1f1ac199-21d4-4237-b9cd-d5ca290f9311", "trace_id": "f16970d3-f662-4eab-992b-bc3f40c3a761", "request_id": "1f1ac199-21d4-4237-b9cd-d5ca290f9311", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:46.770858Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=98", "trace_id": "f16970d3-f662-4eab-992b-bc3f40c3a761", "request_id": "1f1ac199-21d4-4237-b9cd-d5ca290f9311", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:47.192638Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "c7d32ced-7ac9-4105-9d18-9c007f83ef34", "request_id": "1f1ac199-21d4-4237-b9cd-d5ca290f9311", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 421.3860034942627, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:14:47.192974Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=421.84ms", "trace_id": "c7d32ced-7ac9-4105-9d18-9c007f83ef34", "request_id": "1f1ac199-21d4-4237-b9cd-d5ca290f9311", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:47.193205Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "c7d32ced-7ac9-4105-9d18-9c007f83ef34", "request_id": "1f1ac199-21d4-4237-b9cd-d5ca290f9311", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:14:47.193693Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=422.98, trace_id=f16970d3-f662-4eab-992b-bc3f40c3a761", "trace_id": "f16970d3-f662-4eab-992b-bc3f40c3a761", "request_id": "1f1ac199-21d4-4237-b9cd-d5ca290f9311", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:55.110558Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=dc389933-ca45-4929-a430-956ea9330c7a, request_id=c661ac13-3e4a-4e33-a344-dc3593bf0d08", "trace_id": "dc389933-ca45-4929-a430-956ea9330c7a", "request_id": "c661ac13-3e4a-4e33-a344-dc3593bf0d08", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:55.110711Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=97", "trace_id": "dc389933-ca45-4929-a430-956ea9330c7a", "request_id": "c661ac13-3e4a-4e33-a344-dc3593bf0d08", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:55.523024Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "4b929e89-7f5a-4806-a551-50ee765547a8", "request_id": "c661ac13-3e4a-4e33-a344-dc3593bf0d08", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 411.8459224700928, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:14:55.523331Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=412.32ms", "trace_id": "4b929e89-7f5a-4806-a551-50ee765547a8", "request_id": "c661ac13-3e4a-4e33-a344-dc3593bf0d08", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:55.523554Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "4b929e89-7f5a-4806-a551-50ee765547a8", "request_id": "c661ac13-3e4a-4e33-a344-dc3593bf0d08", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:14:55.524017Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=413.57, trace_id=dc389933-ca45-4929-a430-956ea9330c7a", "trace_id": "dc389933-ca45-4929-a430-956ea9330c7a", "request_id": "c661ac13-3e4a-4e33-a344-dc3593bf0d08", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:55.536798Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=2a901302-bbcf-4d5e-8ed4-a518a5a6cef1, request_id=d1aeb8cc-2542-458d-9ab0-4916380f1c45", "trace_id": "2a901302-bbcf-4d5e-8ed4-a518a5a6cef1", "request_id": "d1aeb8cc-2542-458d-9ab0-4916380f1c45", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:55.536904Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=96", "trace_id": "2a901302-bbcf-4d5e-8ed4-a518a5a6cef1", "request_id": "d1aeb8cc-2542-458d-9ab0-4916380f1c45", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:56.017378Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "8b794c3e-3206-4136-8012-38b1cd9c8ef5", "request_id": "d1aeb8cc-2542-458d-9ab0-4916380f1c45", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 480.0560474395752, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:14:56.017665Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=480.50ms", "trace_id": "8b794c3e-3206-4136-8012-38b1cd9c8ef5", "request_id": "d1aeb8cc-2542-458d-9ab0-4916380f1c45", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:14:56.017881Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "8b794c3e-3206-4136-8012-38b1cd9c8ef5", "request_id": "d1aeb8cc-2542-458d-9ab0-4916380f1c45", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:14:56.018406Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=481.66, trace_id=2a901302-bbcf-4d5e-8ed4-a518a5a6cef1", "trace_id": "2a901302-bbcf-4d5e-8ed4-a518a5a6cef1", "request_id": "d1aeb8cc-2542-458d-9ab0-4916380f1c45", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:04.930882Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/chat, trace_id=6ee9ea3e-3325-4075-9f08-2dde45724cac, request_id=93a9fab0-af2a-4d15-9f41-6b0eda2955d9", "trace_id": "6ee9ea3e-3325-4075-9f08-2dde45724cac", "request_id": "93a9fab0-af2a-4d15-9f41-6b0eda2955d9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:04.930990Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat, remaining=19", "trace_id": "6ee9ea3e-3325-4075-9f08-2dde45724cac", "request_id": "93a9fab0-af2a-4d15-9f41-6b0eda2955d9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.420777Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "6f37c4e3-832c-4d27-9f4b-b83159e211f9", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "8d78617b7175b6c6", "execution_time_ms": 489.0711307525635, "row_count": 1, "query_preview": "\n        INSERT INTO chats (chat_id, user_id, topic, total_tokens, is_active, created_at, updated_at"}}
{"timestamp": "2026-01-12T18:15:05.421088Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=489.50ms", "trace_id": "6f37c4e3-832c-4d27-9f4b-b83159e211f9", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.421149Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "create_new_chat", "line": 76, "message": "chat_created_db - chat_id=chat_3c291a71cb664126", "trace_id": "6f37c4e3-832c-4d27-9f4b-b83159e211f9", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.421191Z", "level": "INFO", "logger": "app_logger", "module": "routes", "function": "chat", "line": 198, "message": "chat_created - chat_id=chat_3c291a71cb664126", "trace_id": "6f37c4e3-832c-4d27-9f4b-b83159e211f9", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.421253Z", "level": "INFO", "logger": "app_logger", "module": "cache_manager", "function": "create_chat_session", "line": 69, "message": "chat_session_created - chat_id=chat_3c291a71cb664126, trace_id=4221a267-2d5c-4b12-bb15-f69b80a91878", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.421320Z", "level": "INFO", "logger": "app_logger", "module": "routes", "function": "chat", "line": 245, "message": "agent_invoke_start - chat_id=chat_3c291a71cb664126", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.422639Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "process_input", "line": 46, "message": "input_validated - chat_id=chat_3c291a71cb664126", "trace_id": "1aefbad5-3e4c-4b93-baf1-c7637b253f39", "request_id": "586ec412-13f1-494d-93ad-6a0c73846bd7", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.477454Z", "level": "INFO", "logger": "app_logger", "module": "llm", "function": "get_llm", "line": 24, "message": "llm_initialized - model=openai/gpt-oss-120b, provider=groq", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:05.479240Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 63, "message": "llm_invoke_start - chat_id=chat_3c291a71cb664126, total_messages=2", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.244957Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_llm_call", "line": 160, "message": "llm_call", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883", "extra": {"model": "openai/gpt-oss-120b", "input_tokens": 959, "output_tokens": 37, "total_tokens": 996, "latency_ms": 821.6168880462646}}
{"timestamp": "2026-01-12T18:15:06.245109Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "add_message_to_cache", "line": 242, "message": "message_cached - chat_id=chat_3c291a71cb664126, role=user, tokens=959, cumulative_total=959, unsaved_count=1", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.245161Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "add_message_to_cache", "line": 242, "message": "message_cached - chat_id=chat_3c291a71cb664126, role=assistant, tokens=37, cumulative_total=996, unsaved_count=2", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.245214Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 166, "message": "llm_response_generated - chat_id=chat_3c291a71cb664126, input_tokens=959, output_tokens=37, turn_total=996, cumulative_total=996, latency_ms=821.62", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.246583Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "save_messages", "line": 209, "message": "conversation_turn_complete - chat_id=chat_3c291a71cb664126, cumulative_total=996, cumulative_input=959, cumulative_output=37, turns=2", "trace_id": "4221a267-2d5c-4b12-bb15-f69b80a91878", "request_id": "4d59e70f-9341-4496-b310-af2d2649512f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.247326Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/chat, status=200, duration_ms=1316.51, trace_id=6ee9ea3e-3325-4075-9f08-2dde45724cac", "trace_id": "6ee9ea3e-3325-4075-9f08-2dde45724cac", "request_id": "93a9fab0-af2a-4d15-9f41-6b0eda2955d9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.250246Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/history, trace_id=fb310ea3-2be9-405c-b7bf-8af79a95ffc1, request_id=a196bed3-2419-4100-9496-9d202d546447", "trace_id": "fb310ea3-2be9-405c-b7bf-8af79a95ffc1", "request_id": "a196bed3-2419-4100-9496-9d202d546447", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.250349Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/history, remaining=98", "trace_id": "fb310ea3-2be9-405c-b7bf-8af79a95ffc1", "request_id": "a196bed3-2419-4100-9496-9d202d546447", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.716076Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": null, "request_id": null, "user_id_hash": null, "extra": {"query_hash": "7cdfcb9de1b99f38", "execution_time_ms": 468.3659076690674, "row_count": 0, "query_preview": "\n            INSERT INTO messages (chat_id, session_id, role, content, tokens, created_at)\n         "}}
{"timestamp": "2026-01-12T18:15:06.716400Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=0, total_time=468.81ms", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:15:06.760875Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "1672179c-a356-4deb-ae6d-b62d86f54e2f", "request_id": "a196bed3-2419-4100-9496-9d202d546447", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "95d04ea0799f4b08", "execution_time_ms": 510.0400447845459, "row_count": 28, "query_preview": "\n        SELECT \n            c.chat_id,\n            c.topic,\n            c.total_tokens,\n           "}}
{"timestamp": "2026-01-12T18:15:06.761139Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=28, total_time=510.51ms", "trace_id": "1672179c-a356-4deb-ae6d-b62d86f54e2f", "request_id": "a196bed3-2419-4100-9496-9d202d546447", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.761192Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "load_chat_history", "line": 484, "message": "chat_history_loaded - user_id=752110e1..., count=28", "trace_id": "1672179c-a356-4deb-ae6d-b62d86f54e2f", "request_id": "a196bed3-2419-4100-9496-9d202d546447", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.761430Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/history, status=200, duration_ms=511.28, trace_id=fb310ea3-2be9-405c-b7bf-8af79a95ffc1", "trace_id": "fb310ea3-2be9-405c-b7bf-8af79a95ffc1", "request_id": "a196bed3-2419-4100-9496-9d202d546447", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.763035Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=e4f07c36-4852-46e0-b1cd-154e39173db9, request_id=89abde08-2efc-4cb4-967b-133ce82cefd6", "trace_id": "e4f07c36-4852-46e0-b1cd-154e39173db9", "request_id": "89abde08-2efc-4cb4-967b-133ce82cefd6", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:06.763096Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=95", "trace_id": "e4f07c36-4852-46e0-b1cd-154e39173db9", "request_id": "89abde08-2efc-4cb4-967b-133ce82cefd6", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:07.097749Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": null, "request_id": null, "user_id_hash": null, "extra": {"query_hash": "ae5458016ba59196", "execution_time_ms": 381.03294372558594, "row_count": 0, "query_preview": "\n            UPDATE chats\n            SET total_tokens = 996, updated_at = NOW()\n            WHERE c"}}
{"timestamp": "2026-01-12T18:15:07.098405Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=0, total_time=381.86ms", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:15:07.098531Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "save_chat_to_db", "line": 351, "message": "chat_saved - chat_id=chat_3c291a71cb664126, messages_saved=2, cumulative_tokens=996", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:15:07.332497Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "fc9e9981-90e8-41a5-abc2-2541c981349d", "request_id": "89abde08-2efc-4cb4-967b-133ce82cefd6", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 569.0391063690186, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:15:07.332742Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=569.41ms", "trace_id": "fc9e9981-90e8-41a5-abc2-2541c981349d", "request_id": "89abde08-2efc-4cb4-967b-133ce82cefd6", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:07.332958Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "fc9e9981-90e8-41a5-abc2-2541c981349d", "request_id": "89abde08-2efc-4cb4-967b-133ce82cefd6", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:15:07.333446Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=570.45, trace_id=e4f07c36-4852-46e0-b1cd-154e39173db9", "trace_id": "e4f07c36-4852-46e0-b1cd-154e39173db9", "request_id": "89abde08-2efc-4cb4-967b-133ce82cefd6", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:07.345717Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=bcbafd90-b6ee-4829-81e0-129306656424, request_id=50a077a9-5768-4327-8c09-3d111aff158b", "trace_id": "bcbafd90-b6ee-4829-81e0-129306656424", "request_id": "50a077a9-5768-4327-8c09-3d111aff158b", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:07.345788Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=94", "trace_id": "bcbafd90-b6ee-4829-81e0-129306656424", "request_id": "50a077a9-5768-4327-8c09-3d111aff158b", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:07.803023Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "350b1f70-d92f-4f29-ae0e-5b3994aea178", "request_id": "50a077a9-5768-4327-8c09-3d111aff158b", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 456.83813095092773, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:15:07.803310Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=457.31ms", "trace_id": "350b1f70-d92f-4f29-ae0e-5b3994aea178", "request_id": "50a077a9-5768-4327-8c09-3d111aff158b", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:07.803506Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "350b1f70-d92f-4f29-ae0e-5b3994aea178", "request_id": "50a077a9-5768-4327-8c09-3d111aff158b", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:15:07.804003Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=458.30, trace_id=bcbafd90-b6ee-4829-81e0-129306656424", "trace_id": "bcbafd90-b6ee-4829-81e0-129306656424", "request_id": "50a077a9-5768-4327-8c09-3d111aff158b", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.039927Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/chat, trace_id=ce653b68-5832-46cb-b76d-b0523c8d06aa, request_id=ec4f04cb-e676-4d91-b488-f8bfa0983b42", "trace_id": "ce653b68-5832-46cb-b76d-b0523c8d06aa", "request_id": "ec4f04cb-e676-4d91-b488-f8bfa0983b42", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.040076Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat, remaining=18", "trace_id": "ce653b68-5832-46cb-b76d-b0523c8d06aa", "request_id": "ec4f04cb-e676-4d91-b488-f8bfa0983b42", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.040609Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "get_or_load_chat", "line": 116, "message": "chat_cache_hit - chat_id=chat_3c291a71cb664126", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.040693Z", "level": "INFO", "logger": "app_logger", "module": "routes", "function": "chat", "line": 191, "message": "chat_continue - chat_id=chat_3c291a71cb664126", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.040789Z", "level": "INFO", "logger": "app_logger", "module": "routes", "function": "chat", "line": 245, "message": "agent_invoke_start - chat_id=chat_3c291a71cb664126", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.042097Z", "level": "INFO", "logger": "app_logger", "module": "checkpointer", "function": "aget_tuple", "line": 120, "message": "adaptive_checkpoint_windowed - original=6, windowed=6, tokens=16", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.042738Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "process_input", "line": 46, "message": "input_validated - chat_id=chat_3c291a71cb664126", "trace_id": "554c2b95-1460-4f14-b0fb-d84cb424c564", "request_id": "88fb89eb-92a7-402d-b887-3a1b3afac34f", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.043088Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 63, "message": "llm_invoke_start - chat_id=chat_3c291a71cb664126, total_messages=18", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.696329Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_llm_call", "line": 160, "message": "llm_call", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883", "extra": {"model": "openai/gpt-oss-120b", "input_tokens": 1113, "output_tokens": 164, "total_tokens": 1277, "latency_ms": 653.0601978302002}}
{"timestamp": "2026-01-12T18:15:27.696480Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "add_message_to_cache", "line": 242, "message": "message_cached - chat_id=chat_3c291a71cb664126, role=user, tokens=1113, cumulative_total=2109, unsaved_count=1", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.696550Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "add_message_to_cache", "line": 242, "message": "message_cached - chat_id=chat_3c291a71cb664126, role=assistant, tokens=164, cumulative_total=2273, unsaved_count=2", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.696622Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 166, "message": "llm_response_generated - chat_id=chat_3c291a71cb664126, input_tokens=1113, output_tokens=164, turn_total=1277, cumulative_total=2273, latency_ms=653.06", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.696964Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "route_after_llm", "line": 227, "message": "routing_to_tools - tools=['query_database_with_offload']", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:27.698655Z", "level": "INFO", "logger": "app_logger", "module": "tools", "function": "query_database_with_offload", "line": 66, "message": "tool_exec_start - tool=query_database, query_hash=45b4e2382f2bf29f", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.211825Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "45b4e2382f2bf29f", "execution_time_ms": 512.8576755523682, "row_count": 5, "query_preview": "SELECT * FROM invoices ORDER BY invoice_date"}}
{"timestamp": "2026-01-12T18:15:28.212180Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=5, total_time=513.41ms", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.212453Z", "level": "INFO", "logger": "app_logger", "module": "context_offloader", "function": "store", "line": 164, "message": "context_offload_stored - session_id=session_8eed2a59f28b, rows=5, chunks=5, chunk_size=100", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.212557Z", "level": "INFO", "logger": "app_logger", "module": "tools", "function": "query_database_with_offload", "line": 108, "message": "tool_exec_complete - tool=query_database, query_hash=45b4e2382f2bf29f, rows=5, chunks=5, duration_ms=513.65, offload=yes", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.213142Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 63, "message": "llm_invoke_start - chat_id=chat_3c291a71cb664126, total_messages=20", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.799277Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_llm_call", "line": 160, "message": "llm_call", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883", "extra": {"model": "openai/gpt-oss-120b", "input_tokens": 1370, "output_tokens": 52, "total_tokens": 1422, "latency_ms": 586.0888957977295}}
{"timestamp": "2026-01-12T18:15:28.799354Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 166, "message": "llm_response_generated - chat_id=chat_3c291a71cb664126, input_tokens=1370, output_tokens=52, turn_total=1422, cumulative_total=996, latency_ms=586.09", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.799590Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "route_after_llm", "line": 227, "message": "routing_to_tools - tools=['get_context_chunks']", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.800629Z", "level": "INFO", "logger": "app_logger", "module": "tools", "function": "get_context_chunks", "line": 167, "message": "tool_exec_start - tool=get_chunks, session_id=session_8eed2a59f28b, chunks=[0]", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.800719Z", "level": "INFO", "logger": "app_logger", "module": "context_offloader", "function": "get_chunks", "line": 243, "message": "context_offload_retrieved - session_id=session_8eed2a59f28b, chunks_requested=[0], rows=1, progress=20.0%, retrieved=1/5", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.800802Z", "level": "INFO", "logger": "app_logger", "module": "tools", "function": "get_context_chunks", "line": 184, "message": "tool_exec_complete - tool=get_chunks, session_id=session_8eed2a59f28b, chunks=[0], rows=1, duration_ms=0.17", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:28.801207Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 63, "message": "llm_invoke_start - chat_id=chat_3c291a71cb664126, total_messages=22", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:29.312551Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_llm_call", "line": 160, "message": "llm_call", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883", "extra": {"model": "openai/gpt-oss-120b", "input_tokens": 1866, "output_tokens": 97, "total_tokens": 1963, "latency_ms": 511.289119720459}}
{"timestamp": "2026-01-12T18:15:29.312625Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 166, "message": "llm_response_generated - chat_id=chat_3c291a71cb664126, input_tokens=1866, output_tokens=97, turn_total=1963, cumulative_total=996, latency_ms=511.29", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:29.312850Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "route_after_llm", "line": 227, "message": "routing_to_tools - tools=['get_context_chunks']", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:29.313860Z", "level": "INFO", "logger": "app_logger", "module": "tools", "function": "get_context_chunks", "line": 167, "message": "tool_exec_start - tool=get_chunks, session_id=session_8eed2a59f28b, chunks=[1, 2, 3, 4]", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:29.313932Z", "level": "INFO", "logger": "app_logger", "module": "context_offloader", "function": "get_chunks", "line": 243, "message": "context_offload_retrieved - session_id=session_8eed2a59f28b, chunks_requested=[1, 2, 3, 4], rows=4, progress=100.0%, retrieved=5/5", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:29.314032Z", "level": "INFO", "logger": "app_logger", "module": "tools", "function": "get_context_chunks", "line": 184, "message": "tool_exec_complete - tool=get_chunks, session_id=session_8eed2a59f28b, chunks=[1, 2, 3, 4], rows=4, duration_ms=0.18", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:29.314515Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 63, "message": "llm_invoke_start - chat_id=chat_3c291a71cb664126, total_messages=24", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:30.952660Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_llm_call", "line": 160, "message": "llm_call", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883", "extra": {"model": "openai/gpt-oss-120b", "input_tokens": 3127, "output_tokens": 545, "total_tokens": 3672, "latency_ms": 1637.9683017730713}}
{"timestamp": "2026-01-12T18:15:30.952820Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "add_message_to_cache", "line": 242, "message": "message_cached - chat_id=chat_3c291a71cb664126, role=assistant, tokens=545, cumulative_total=2818, unsaved_count=3", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:30.952901Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "generate_response", "line": 166, "message": "llm_response_generated - chat_id=chat_3c291a71cb664126, input_tokens=3127, output_tokens=545, turn_total=3672, cumulative_total=2818, latency_ms=1637.97", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:30.954110Z", "level": "INFO", "logger": "app_logger", "module": "nodes", "function": "save_messages", "line": 209, "message": "conversation_turn_complete - chat_id=chat_3c291a71cb664126, cumulative_total=2818, cumulative_input=2072, cumulative_output=746, turns=5", "trace_id": "947a917f-3c24-43a6-900f-958360667d49", "request_id": "2305a9a2-5a74-4a04-865f-eba8953d1585", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:30.955427Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/chat, status=200, duration_ms=3915.53, trace_id=ce653b68-5832-46cb-b76d-b0523c8d06aa", "trace_id": "ce653b68-5832-46cb-b76d-b0523c8d06aa", "request_id": "ec4f04cb-e676-4d91-b488-f8bfa0983b42", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:30.959133Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/history, trace_id=cd9b7682-b7a7-49db-8e3b-7a2ace6826eb, request_id=3070e92e-c1a3-41ac-9ada-7985769eb7eb", "trace_id": "cd9b7682-b7a7-49db-8e3b-7a2ace6826eb", "request_id": "3070e92e-c1a3-41ac-9ada-7985769eb7eb", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:30.959202Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/history, remaining=97", "trace_id": "cd9b7682-b7a7-49db-8e3b-7a2ace6826eb", "request_id": "3070e92e-c1a3-41ac-9ada-7985769eb7eb", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.386973Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "db8f497e-eb46-48a9-ad4d-dc73d80e88de", "request_id": "3070e92e-c1a3-41ac-9ada-7985769eb7eb", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "95d04ea0799f4b08", "execution_time_ms": 427.14715003967285, "row_count": 28, "query_preview": "\n        SELECT \n            c.chat_id,\n            c.topic,\n            c.total_tokens,\n           "}}
{"timestamp": "2026-01-12T18:15:31.387476Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=28, total_time=427.95ms", "trace_id": "db8f497e-eb46-48a9-ad4d-dc73d80e88de", "request_id": "3070e92e-c1a3-41ac-9ada-7985769eb7eb", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.387575Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "load_chat_history", "line": 484, "message": "chat_history_loaded - user_id=752110e1..., count=28", "trace_id": "db8f497e-eb46-48a9-ad4d-dc73d80e88de", "request_id": "3070e92e-c1a3-41ac-9ada-7985769eb7eb", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.388099Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/history, status=200, duration_ms=428.94, trace_id=cd9b7682-b7a7-49db-8e3b-7a2ace6826eb", "trace_id": "cd9b7682-b7a7-49db-8e3b-7a2ace6826eb", "request_id": "3070e92e-c1a3-41ac-9ada-7985769eb7eb", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.391013Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=ed9805b2-3cb1-41be-85eb-bd7d10f7488b, request_id=3139675c-784e-4cc5-85dd-a6e359563558", "trace_id": "ed9805b2-3cb1-41be-85eb-bd7d10f7488b", "request_id": "3139675c-784e-4cc5-85dd-a6e359563558", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.391139Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=93", "trace_id": "ed9805b2-3cb1-41be-85eb-bd7d10f7488b", "request_id": "3139675c-784e-4cc5-85dd-a6e359563558", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.430371Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": null, "request_id": null, "user_id_hash": null, "extra": {"query_hash": "ae32979c6950caa2", "execution_time_ms": 474.2777347564697, "row_count": 0, "query_preview": "\n            INSERT INTO messages (chat_id, session_id, role, content, tokens, created_at)\n         "}}
{"timestamp": "2026-01-12T18:15:31.430897Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=0, total_time=475.01ms", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:15:31.845012Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "257d1fb1-2310-448f-9b52-b4a30a753c08", "request_id": "3139675c-784e-4cc5-85dd-a6e359563558", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 453.13096046447754, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:15:31.845604Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=453.96ms", "trace_id": "257d1fb1-2310-448f-9b52-b4a30a753c08", "request_id": "3139675c-784e-4cc5-85dd-a6e359563558", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.846013Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "257d1fb1-2310-448f-9b52-b4a30a753c08", "request_id": "3139675c-784e-4cc5-85dd-a6e359563558", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:15:31.847584Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=456.69, trace_id=ed9805b2-3cb1-41be-85eb-bd7d10f7488b", "trace_id": "ed9805b2-3cb1-41be-85eb-bd7d10f7488b", "request_id": "3139675c-784e-4cc5-85dd-a6e359563558", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.866589Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=8ce3eb9d-f08b-408f-a7d8-ff1d67705884, request_id=d9e58462-9478-4e08-8230-33231616583e", "trace_id": "8ce3eb9d-f08b-408f-a7d8-ff1d67705884", "request_id": "d9e58462-9478-4e08-8230-33231616583e", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.866681Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=92", "trace_id": "8ce3eb9d-f08b-408f-a7d8-ff1d67705884", "request_id": "d9e58462-9478-4e08-8230-33231616583e", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:31.913436Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": null, "request_id": null, "user_id_hash": null, "extra": {"query_hash": "269152c17cdf69f1", "execution_time_ms": 482.1820259094238, "row_count": 0, "query_preview": "\n            UPDATE chats\n            SET total_tokens = 2818, updated_at = NOW()\n            WHERE "}}
{"timestamp": "2026-01-12T18:15:31.914104Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=0, total_time=482.94ms", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:15:31.914182Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "save_chat_to_db", "line": 351, "message": "chat_saved - chat_id=chat_3c291a71cb664126, messages_saved=3, cumulative_tokens=2818", "trace_id": null, "request_id": null, "user_id_hash": null}
{"timestamp": "2026-01-12T18:15:32.219567Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "0cb34f53-ef5e-4606-bc2f-13370a4365b2", "request_id": "d9e58462-9478-4e08-8230-33231616583e", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 352.4808883666992, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:15:32.219904Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=352.96ms", "trace_id": "0cb34f53-ef5e-4606-bc2f-13370a4365b2", "request_id": "d9e58462-9478-4e08-8230-33231616583e", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:15:32.220174Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "0cb34f53-ef5e-4606-bc2f-13370a4365b2", "request_id": "d9e58462-9478-4e08-8230-33231616583e", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:15:32.220792Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=354.26, trace_id=8ce3eb9d-f08b-408f-a7d8-ff1d67705884", "trace_id": "8ce3eb9d-f08b-408f-a7d8-ff1d67705884", "request_id": "d9e58462-9478-4e08-8230-33231616583e", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:30.549750Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=2f69c865-166d-4ad5-a299-ff76b59e5802, request_id=4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "trace_id": "2f69c865-166d-4ad5-a299-ff76b59e5802", "request_id": "4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:30.550572Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=97", "trace_id": "2f69c865-166d-4ad5-a299-ff76b59e5802", "request_id": "4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:31.179977Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "ac072b33-e38f-41b8-ba39-2c6df8b11016", "request_id": "4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 628.9129257202148, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:31.180263Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=629.42ms", "trace_id": "ac072b33-e38f-41b8-ba39-2c6df8b11016", "request_id": "4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:31.180457Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "ac072b33-e38f-41b8-ba39-2c6df8b11016", "request_id": "4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:31.181771Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=632.10, trace_id=2f69c865-166d-4ad5-a299-ff76b59e5802", "trace_id": "2f69c865-166d-4ad5-a299-ff76b59e5802", "request_id": "4c2c1a73-c2ec-49f9-b925-65bb0dac1edf", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:31.193662Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=b282cd21-a86a-4557-8148-5d5fae708db3, request_id=e9e0bc09-2410-4286-b37f-671020acabd9", "trace_id": "b282cd21-a86a-4557-8148-5d5fae708db3", "request_id": "e9e0bc09-2410-4286-b37f-671020acabd9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:31.193744Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=96", "trace_id": "b282cd21-a86a-4557-8148-5d5fae708db3", "request_id": "e9e0bc09-2410-4286-b37f-671020acabd9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:31.642584Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "45bb7a61-2b3a-4483-ac48-4b2515e94e88", "request_id": "e9e0bc09-2410-4286-b37f-671020acabd9", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 448.40383529663086, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:31.642856Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=448.84ms", "trace_id": "45bb7a61-2b3a-4483-ac48-4b2515e94e88", "request_id": "e9e0bc09-2410-4286-b37f-671020acabd9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:31.643045Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "45bb7a61-2b3a-4483-ac48-4b2515e94e88", "request_id": "e9e0bc09-2410-4286-b37f-671020acabd9", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:31.643515Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=449.93, trace_id=b282cd21-a86a-4557-8148-5d5fae708db3", "trace_id": "b282cd21-a86a-4557-8148-5d5fae708db3", "request_id": "e9e0bc09-2410-4286-b37f-671020acabd9", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:38.074702Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/chat/chat_3c291a71cb664126/end, trace_id=a78237ce-6e1b-4472-8e49-77caad8a24a3, request_id=b325fb63-7aa4-43ca-864a-5b9e66dd9675", "trace_id": "a78237ce-6e1b-4472-8e49-77caad8a24a3", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:38.074851Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/chat_3c291a71cb664126/end, remaining=99", "trace_id": "a78237ce-6e1b-4472-8e49-77caad8a24a3", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:38.550874Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "a077e1cf-4265-48ab-bee0-1dca2f0db86d", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "ec4490525b10147f", "execution_time_ms": 475.59499740600586, "row_count": 0, "query_preview": "\n        INSERT INTO chat_metrics (\n            chat_id,\n            session_id,\n            total_i"}}
{"timestamp": "2026-01-12T18:16:38.551165Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=0, total_time=476.02ms", "trace_id": "a077e1cf-4265-48ab-bee0-1dca2f0db86d", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:38.551224Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "save_session_metrics", "line": 434, "message": "session_metrics_saved - chat_id=chat_3c291a71cb664126, duration=92.7s, messages=5, turns=2, tokens=2818", "trace_id": "a077e1cf-4265-48ab-bee0-1dca2f0db86d", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:38.551259Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "end_session", "line": 454, "message": "session_ended - chat_id=chat_3c291a71cb664126", "trace_id": "a077e1cf-4265-48ab-bee0-1dca2f0db86d", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:38.551556Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/chat/chat_3c291a71cb664126/end, status=200, duration_ms=476.89, trace_id=a78237ce-6e1b-4472-8e49-77caad8a24a3", "trace_id": "a78237ce-6e1b-4472-8e49-77caad8a24a3", "request_id": "b325fb63-7aa4-43ca-864a-5b9e66dd9675", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:45.766015Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/auth/login, trace_id=71e32aad-f30d-45e8-b9b2-8045abf25d35, request_id=1c3cf563-6735-4137-b798-ef78fdb0f41b", "trace_id": "71e32aad-f30d-45e8-b9b2-8045abf25d35", "request_id": "1c3cf563-6735-4137-b798-ef78fdb0f41b", "user_id_hash": null}
{"timestamp": "2026-01-12T18:16:45.766123Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/auth/login, remaining=3", "trace_id": "71e32aad-f30d-45e8-b9b2-8045abf25d35", "request_id": "1c3cf563-6735-4137-b798-ef78fdb0f41b", "user_id_hash": null}
{"timestamp": "2026-01-12T18:16:46.820184Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "get_access_token", "line": 51, "message": "auth_success - email=vikram.dev@pwc.com, uid=752110e1-4280-4bab-a935-2013305ed39b, trace_id=c2077b48-6508-45ac-b707-dac62d93b6cc", "trace_id": "c2077b48-6508-45ac-b707-dac62d93b6cc", "request_id": "ece358e0-b52d-48fd-bac5-d11a3b5173f2", "user_id_hash": null}
{"timestamp": "2026-01-12T18:16:46.820490Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/auth/login, status=200, duration_ms=1054.48, trace_id=71e32aad-f30d-45e8-b9b2-8045abf25d35", "trace_id": "71e32aad-f30d-45e8-b9b2-8045abf25d35", "request_id": "1c3cf563-6735-4137-b798-ef78fdb0f41b", "user_id_hash": null}
{"timestamp": "2026-01-12T18:16:46.822447Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/history, trace_id=c33c34c5-3da6-41cb-8df1-ef1c2d364684, request_id=fd1f2315-3677-40ad-bb11-41a48d3675ff", "trace_id": "c33c34c5-3da6-41cb-8df1-ef1c2d364684", "request_id": "fd1f2315-3677-40ad-bb11-41a48d3675ff", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:46.822535Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/history, remaining=99", "trace_id": "c33c34c5-3da6-41cb-8df1-ef1c2d364684", "request_id": "fd1f2315-3677-40ad-bb11-41a48d3675ff", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.178445Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "ab731101-3443-4cc2-8c3d-acefc4b5074e", "request_id": "fd1f2315-3677-40ad-bb11-41a48d3675ff", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "95d04ea0799f4b08", "execution_time_ms": 355.4871082305908, "row_count": 28, "query_preview": "\n        SELECT \n            c.chat_id,\n            c.topic,\n            c.total_tokens,\n           "}}
{"timestamp": "2026-01-12T18:16:47.178800Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=28, total_time=355.99ms", "trace_id": "ab731101-3443-4cc2-8c3d-acefc4b5074e", "request_id": "fd1f2315-3677-40ad-bb11-41a48d3675ff", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.178889Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "load_chat_history", "line": 484, "message": "chat_history_loaded - user_id=752110e1..., count=28", "trace_id": "ab731101-3443-4cc2-8c3d-acefc4b5074e", "request_id": "fd1f2315-3677-40ad-bb11-41a48d3675ff", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.179166Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/history, status=200, duration_ms=356.80, trace_id=c33c34c5-3da6-41cb-8df1-ef1c2d364684", "trace_id": "c33c34c5-3da6-41cb-8df1-ef1c2d364684", "request_id": "fd1f2315-3677-40ad-bb11-41a48d3675ff", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.180808Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=cc44b73b-a813-4e16-acad-9033f9cba72f, request_id=62a21206-61bf-4517-9d8d-9f48560faec8", "trace_id": "cc44b73b-a813-4e16-acad-9033f9cba72f", "request_id": "62a21206-61bf-4517-9d8d-9f48560faec8", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.180867Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=97", "trace_id": "cc44b73b-a813-4e16-acad-9033f9cba72f", "request_id": "62a21206-61bf-4517-9d8d-9f48560faec8", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.631741Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "ff354a96-977b-41c3-bdb6-f62511bb2526", "request_id": "62a21206-61bf-4517-9d8d-9f48560faec8", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 450.5009651184082, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:47.632125Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=451.02ms", "trace_id": "ff354a96-977b-41c3-bdb6-f62511bb2526", "request_id": "62a21206-61bf-4517-9d8d-9f48560faec8", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.632368Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "ff354a96-977b-41c3-bdb6-f62511bb2526", "request_id": "62a21206-61bf-4517-9d8d-9f48560faec8", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:47.632840Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=452.06, trace_id=cc44b73b-a813-4e16-acad-9033f9cba72f", "trace_id": "cc44b73b-a813-4e16-acad-9033f9cba72f", "request_id": "62a21206-61bf-4517-9d8d-9f48560faec8", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.647761Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=20fce1da-ccdb-4925-8ba3-5a2643f5aad2, request_id=2cbd690c-a436-47dd-b68f-4cc6feb51a20", "trace_id": "20fce1da-ccdb-4925-8ba3-5a2643f5aad2", "request_id": "2cbd690c-a436-47dd-b68f-4cc6feb51a20", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:47.647843Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=96", "trace_id": "20fce1da-ccdb-4925-8ba3-5a2643f5aad2", "request_id": "2cbd690c-a436-47dd-b68f-4cc6feb51a20", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:48.169336Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "118ea69a-bf60-4cdc-9197-85b9b20d1e99", "request_id": "2cbd690c-a436-47dd-b68f-4cc6feb51a20", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 521.000862121582, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:48.169958Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=521.82ms", "trace_id": "118ea69a-bf60-4cdc-9197-85b9b20d1e99", "request_id": "2cbd690c-a436-47dd-b68f-4cc6feb51a20", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:48.170439Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "118ea69a-bf60-4cdc-9197-85b9b20d1e99", "request_id": "2cbd690c-a436-47dd-b68f-4cc6feb51a20", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:48.171336Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=523.57, trace_id=20fce1da-ccdb-4925-8ba3-5a2643f5aad2", "trace_id": "20fce1da-ccdb-4925-8ba3-5a2643f5aad2", "request_id": "2cbd690c-a436-47dd-b68f-4cc6feb51a20", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:54.832993Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=cb7c293f-722a-4380-9e90-8d7a705a93a5, request_id=68009420-8cad-48fe-ace8-8d85a1f816c2", "trace_id": "cb7c293f-722a-4380-9e90-8d7a705a93a5", "request_id": "68009420-8cad-48fe-ace8-8d85a1f816c2", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:54.833138Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=95", "trace_id": "cb7c293f-722a-4380-9e90-8d7a705a93a5", "request_id": "68009420-8cad-48fe-ace8-8d85a1f816c2", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:55.314142Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "de154657-3713-47d4-a5e9-fa3d68f2bed8", "request_id": "68009420-8cad-48fe-ace8-8d85a1f816c2", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 480.5922508239746, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:55.314396Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=480.98ms", "trace_id": "de154657-3713-47d4-a5e9-fa3d68f2bed8", "request_id": "68009420-8cad-48fe-ace8-8d85a1f816c2", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:55.314589Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "de154657-3713-47d4-a5e9-fa3d68f2bed8", "request_id": "68009420-8cad-48fe-ace8-8d85a1f816c2", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:55.315073Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=482.14, trace_id=cb7c293f-722a-4380-9e90-8d7a705a93a5", "trace_id": "cb7c293f-722a-4380-9e90-8d7a705a93a5", "request_id": "68009420-8cad-48fe-ace8-8d85a1f816c2", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:55.327646Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=f5df0f4b-f8db-4b10-acf8-5c535dd745f4, request_id=4c742ff9-3bee-4298-a50b-376f69467b6a", "trace_id": "f5df0f4b-f8db-4b10-acf8-5c535dd745f4", "request_id": "4c742ff9-3bee-4298-a50b-376f69467b6a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:55.327746Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=94", "trace_id": "f5df0f4b-f8db-4b10-acf8-5c535dd745f4", "request_id": "4c742ff9-3bee-4298-a50b-376f69467b6a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:55.802722Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "9e471dba-53d0-49b4-94b7-3507976ea4cd", "request_id": "4c742ff9-3bee-4298-a50b-376f69467b6a", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 474.5910167694092, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:55.803011Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=475.01ms", "trace_id": "9e471dba-53d0-49b4-94b7-3507976ea4cd", "request_id": "4c742ff9-3bee-4298-a50b-376f69467b6a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:55.803239Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "9e471dba-53d0-49b4-94b7-3507976ea4cd", "request_id": "4c742ff9-3bee-4298-a50b-376f69467b6a", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:55.804030Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=476.47, trace_id=f5df0f4b-f8db-4b10-acf8-5c535dd745f4", "trace_id": "f5df0f4b-f8db-4b10-acf8-5c535dd745f4", "request_id": "4c742ff9-3bee-4298-a50b-376f69467b6a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:57.794738Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/chat_3c291a71cb664126/messages, trace_id=94a55678-3415-4d4f-9142-9fa0fc207528, request_id=a8144a1c-ce1b-4dd8-8a2e-995cc85df783", "trace_id": "94a55678-3415-4d4f-9142-9fa0fc207528", "request_id": "a8144a1c-ce1b-4dd8-8a2e-995cc85df783", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:57.794845Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/chat_3c291a71cb664126/messages, remaining=99", "trace_id": "94a55678-3415-4d4f-9142-9fa0fc207528", "request_id": "a8144a1c-ce1b-4dd8-8a2e-995cc85df783", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:58.222707Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "75fa8c1b-9124-43de-ae62-403288624c54", "request_id": "a8144a1c-ce1b-4dd8-8a2e-995cc85df783", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "d5fe4fae534fb916", "execution_time_ms": 427.4890422821045, "row_count": 5, "query_preview": "\n        SELECT role, content, tokens, created_at\n        FROM messages\n        WHERE chat_id = 'cha"}}
{"timestamp": "2026-01-12T18:16:58.222993Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=5, total_time=427.88ms", "trace_id": "75fa8c1b-9124-43de-ae62-403288624c54", "request_id": "a8144a1c-ce1b-4dd8-8a2e-995cc85df783", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:58.223254Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/chat_3c291a71cb664126/messages, status=200, duration_ms=428.60, trace_id=94a55678-3415-4d4f-9142-9fa0fc207528", "trace_id": "94a55678-3415-4d4f-9142-9fa0fc207528", "request_id": "a8144a1c-ce1b-4dd8-8a2e-995cc85df783", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:58.235953Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=4c375387-e9ab-4cb8-8bc0-5d852270115f, request_id=cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "trace_id": "4c375387-e9ab-4cb8-8bc0-5d852270115f", "request_id": "cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:58.236033Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=93", "trace_id": "4c375387-e9ab-4cb8-8bc0-5d852270115f", "request_id": "cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:58.726487Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "5cfce3a5-0874-4b08-9d73-259fde3833f4", "request_id": "cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 490.0667667388916, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:16:58.726788Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=490.52ms", "trace_id": "5cfce3a5-0874-4b08-9d73-259fde3833f4", "request_id": "cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:16:58.727002Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "5cfce3a5-0874-4b08-9d73-259fde3833f4", "request_id": "cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:16:58.727518Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=491.60, trace_id=4c375387-e9ab-4cb8-8bc0-5d852270115f", "trace_id": "4c375387-e9ab-4cb8-8bc0-5d852270115f", "request_id": "cb466c8e-f277-4c3e-ba82-4c22e2d294e0", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:01.144538Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/chat/chat_3c291a71cb664126/end, trace_id=2e1e2143-fb19-42d5-8534-002fb38236d1, request_id=950c9b34-39a1-453a-a8a3-2cd4dfba615a", "trace_id": "2e1e2143-fb19-42d5-8534-002fb38236d1", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:01.144616Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/chat_3c291a71cb664126/end, remaining=98", "trace_id": "2e1e2143-fb19-42d5-8534-002fb38236d1", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:01.622928Z", "level": "ERROR", "logger": "app_logger", "module": "client", "function": "_connect_and_exec", "line": 157, "message": "db_query_error - error=duplicate key value violates unique constraint \"chat_metrics_chat_id_session_id_key\", time=476.28068923950195ms", "trace_id": "14c92931-4471-42ff-ad4b-9c9332bf663b", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 116, in _connect_and_exec\n    cur.execute(query)\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/psycopg/cursor.py\", line 97, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UniqueViolation: duplicate key value violates unique constraint \"chat_metrics_chat_id_session_id_key\""}
{"timestamp": "2026-01-12T18:17:01.624774Z", "level": "ERROR", "logger": "app_logger", "module": "client", "function": "run_query", "line": 214, "message": "query_unexpected_error - error=500: Error executing query, time=478.60ms", "trace_id": "14c92931-4471-42ff-ad4b-9c9332bf663b", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 116, in _connect_and_exec\n    cur.execute(query)\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/psycopg/cursor.py\", line 97, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UniqueViolation: duplicate key value violates unique constraint \"chat_metrics_chat_id_session_id_key\"\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 169, in run_query\n    result = await run_in_threadpool(_connect_and_exec, access_token)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 160, in _connect_and_exec\n    raise HTTPException(status_code=500, detail=\"Error executing query\")\nfastapi.exceptions.HTTPException: 500: Error executing query"}
{"timestamp": "2026-01-12T18:17:01.626621Z", "level": "ERROR", "logger": "app_logger", "module": "chat_manager", "function": "save_session_metrics", "line": 440, "message": "session_metrics_save_error - chat_id=chat_3c291a71cb664126, error=500: Unexpected error executing query", "trace_id": "14c92931-4471-42ff-ad4b-9c9332bf663b", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 116, in _connect_and_exec\n    cur.execute(query)\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/psycopg/cursor.py\", line 97, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UniqueViolation: duplicate key value violates unique constraint \"chat_metrics_chat_id_session_id_key\"\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 169, in run_query\n    result = await run_in_threadpool(_connect_and_exec, access_token)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 160, in _connect_and_exec\n    raise HTTPException(status_code=500, detail=\"Error executing query\")\nfastapi.exceptions.HTTPException: 500: Error executing query\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/agent/chat_manager.py\", line 433, in save_session_metrics\n    await run_query(metrics_query, access_token, refresh_token)\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/database/client.py\", line 216, in run_query\n    raise HTTPException(status_code=500, detail=\"Unexpected error executing query\")\nfastapi.exceptions.HTTPException: 500: Unexpected error executing query"}
{"timestamp": "2026-01-12T18:17:01.628095Z", "level": "INFO", "logger": "app_logger", "module": "chat_manager", "function": "end_session", "line": 454, "message": "session_ended - chat_id=chat_3c291a71cb664126", "trace_id": "14c92931-4471-42ff-ad4b-9c9332bf663b", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:01.628294Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/chat/chat_3c291a71cb664126/end, status=200, duration_ms=483.86, trace_id=2e1e2143-fb19-42d5-8534-002fb38236d1", "trace_id": "2e1e2143-fb19-42d5-8534-002fb38236d1", "request_id": "950c9b34-39a1-453a-a8a3-2cd4dfba615a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:01.630209Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/chat_1aa9a7353aba494d/messages, trace_id=2f2faef6-99ab-4847-a0bf-9b8f2f0c68f9, request_id=1058e46d-cc07-4d73-b5c5-4d300e7fa097", "trace_id": "2f2faef6-99ab-4847-a0bf-9b8f2f0c68f9", "request_id": "1058e46d-cc07-4d73-b5c5-4d300e7fa097", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:01.630287Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/chat_1aa9a7353aba494d/messages, remaining=99", "trace_id": "2f2faef6-99ab-4847-a0bf-9b8f2f0c68f9", "request_id": "1058e46d-cc07-4d73-b5c5-4d300e7fa097", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:02.091714Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "f9e18613-1bc9-4db6-9067-fe626d510722", "request_id": "1058e46d-cc07-4d73-b5c5-4d300e7fa097", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c287d0a245814c1", "execution_time_ms": 461.0323905944824, "row_count": 17, "query_preview": "\n        SELECT role, content, tokens, created_at\n        FROM messages\n        WHERE chat_id = 'cha"}}
{"timestamp": "2026-01-12T18:17:02.092054Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=17, total_time=461.54ms", "trace_id": "f9e18613-1bc9-4db6-9067-fe626d510722", "request_id": "1058e46d-cc07-4d73-b5c5-4d300e7fa097", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:02.092319Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/chat_1aa9a7353aba494d/messages, status=200, duration_ms=462.16, trace_id=2f2faef6-99ab-4847-a0bf-9b8f2f0c68f9", "trace_id": "2f2faef6-99ab-4847-a0bf-9b8f2f0c68f9", "request_id": "1058e46d-cc07-4d73-b5c5-4d300e7fa097", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:02.108251Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=ca8ed007-8293-4375-8810-59a98fc3916a, request_id=fcad5119-ec97-4f81-a4a1-08fd32959309", "trace_id": "ca8ed007-8293-4375-8810-59a98fc3916a", "request_id": "fcad5119-ec97-4f81-a4a1-08fd32959309", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:02.108344Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=92", "trace_id": "ca8ed007-8293-4375-8810-59a98fc3916a", "request_id": "fcad5119-ec97-4f81-a4a1-08fd32959309", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:02.547527Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "7db42b89-0df5-4848-9f67-c59540e56394", "request_id": "fcad5119-ec97-4f81-a4a1-08fd32959309", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 438.7860298156738, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:17:02.547878Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=439.28ms", "trace_id": "7db42b89-0df5-4848-9f67-c59540e56394", "request_id": "fcad5119-ec97-4f81-a4a1-08fd32959309", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:02.548159Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "7db42b89-0df5-4848-9f67-c59540e56394", "request_id": "fcad5119-ec97-4f81-a4a1-08fd32959309", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:17:02.548821Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=440.63, trace_id=ca8ed007-8293-4375-8810-59a98fc3916a", "trace_id": "ca8ed007-8293-4375-8810-59a98fc3916a", "request_id": "fcad5119-ec97-4f81-a4a1-08fd32959309", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:06.996941Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=POST, path=/api/chat/chat_1aa9a7353aba494d/end, trace_id=42fbef1c-4c42-4bbf-b3a6-e0185c51818d, request_id=dc304e5d-9975-4b6c-afb8-ef960f640992", "trace_id": "42fbef1c-4c42-4bbf-b3a6-e0185c51818d", "request_id": "dc304e5d-9975-4b6c-afb8-ef960f640992", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:06.997048Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/chat_1aa9a7353aba494d/end, remaining=99", "trace_id": "42fbef1c-4c42-4bbf-b3a6-e0185c51818d", "request_id": "dc304e5d-9975-4b6c-afb8-ef960f640992", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:06.997291Z", "level": "WARNING", "logger": "app_logger", "module": "chat_manager", "function": "end_session", "line": 445, "message": "end_session_chat_not_found - chat_id=chat_1aa9a7353aba494d", "trace_id": "ad49c96d-62aa-4d8b-be2f-bb9aa16eb91f", "request_id": "dc304e5d-9975-4b6c-afb8-ef960f640992", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:06.997540Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=POST, path=/api/chat/chat_1aa9a7353aba494d/end, status=200, duration_ms=0.67, trace_id=42fbef1c-4c42-4bbf-b3a6-e0185c51818d", "trace_id": "42fbef1c-4c42-4bbf-b3a6-e0185c51818d", "request_id": "dc304e5d-9975-4b6c-afb8-ef960f640992", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:06.999167Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/chat/chat_3c291a71cb664126/messages, trace_id=7a64449a-de2a-411d-9cad-cbda4adbbe26, request_id=1c7a2ff5-0140-4363-9b00-107b0806589c", "trace_id": "7a64449a-de2a-411d-9cad-cbda4adbbe26", "request_id": "1c7a2ff5-0140-4363-9b00-107b0806589c", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:06.999221Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/chat/chat_3c291a71cb664126/messages, remaining=98", "trace_id": "7a64449a-de2a-411d-9cad-cbda4adbbe26", "request_id": "1c7a2ff5-0140-4363-9b00-107b0806589c", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:07.497871Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "089fab92-69f6-404c-8e53-fe97507b5828", "request_id": "1c7a2ff5-0140-4363-9b00-107b0806589c", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "d5fe4fae534fb916", "execution_time_ms": 498.3258247375488, "row_count": 5, "query_preview": "\n        SELECT role, content, tokens, created_at\n        FROM messages\n        WHERE chat_id = 'cha"}}
{"timestamp": "2026-01-12T18:17:07.498169Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=5, total_time=498.77ms", "trace_id": "089fab92-69f6-404c-8e53-fe97507b5828", "request_id": "1c7a2ff5-0140-4363-9b00-107b0806589c", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:07.498371Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/chat/chat_3c291a71cb664126/messages, status=200, duration_ms=499.23, trace_id=7a64449a-de2a-411d-9cad-cbda4adbbe26", "trace_id": "7a64449a-de2a-411d-9cad-cbda4adbbe26", "request_id": "1c7a2ff5-0140-4363-9b00-107b0806589c", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:07.510627Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 84, "message": "request_start - method=GET, path=/api/metrics/user, trace_id=54ef5286-3bac-42da-8006-b426875ad631, request_id=9aaf2819-5e34-4c86-be91-e6f77a55304a", "trace_id": "54ef5286-3bac-42da-8006-b426875ad631", "request_id": "9aaf2819-5e34-4c86-be91-e6f77a55304a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:07.510704Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 96, "message": "rate_limit_check - path=/api/metrics/user, remaining=91", "trace_id": "54ef5286-3bac-42da-8006-b426875ad631", "request_id": "9aaf2819-5e34-4c86-be91-e6f77a55304a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:08.130718Z", "level": "INFO", "logger": "app_logger", "module": "log", "function": "log_query", "line": 145, "message": "db_query_executed", "trace_id": "355b1c45-c4b9-43e5-80e7-0cebbce6567c", "request_id": "9aaf2819-5e34-4c86-be91-e6f77a55304a", "user_id_hash": "c55ea77e83770883", "extra": {"query_hash": "2c1250b4f3a7ec6e", "execution_time_ms": 619.6160316467285, "row_count": 1, "query_preview": "\n        SELECT \n            COUNT(DISTINCT c.chat_id) as total_chats,\n            COALESCE(SUM(cm.m"}}
{"timestamp": "2026-01-12T18:17:08.131030Z", "level": "INFO", "logger": "app_logger", "module": "client", "function": "run_query", "line": 171, "message": "query_success - rows=1, total_time=620.11ms", "trace_id": "355b1c45-c4b9-43e5-80e7-0cebbce6567c", "request_id": "9aaf2819-5e34-4c86-be91-e6f77a55304a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:17:08.131248Z", "level": "ERROR", "logger": "app_logger", "module": "routes", "function": "get_user_metrics", "line": 422, "message": "user_metrics_error - error=1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type", "trace_id": "355b1c45-c4b9-43e5-80e7-0cebbce6567c", "request_id": "9aaf2819-5e34-4c86-be91-e6f77a55304a", "user_id_hash": "c55ea77e83770883", "exception": "Traceback (most recent call last):\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent version2/api/routes.py\", line 410, in get_user_metrics\n    return UserMetricsResponse(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/vikram/Documents/projects/vendor_helpdesk_agent/venv/lib/python3.11/site-packages/pydantic/main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for UserMetricsResponse\nlast_activity\n  Input should be a valid string [type=string_type, input_value=datetime.datetime(2026, 1...o=datetime.timezone.utc), input_type=datetime]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_type"}
{"timestamp": "2026-01-12T18:17:08.131638Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "request_tracking_and_rate_limiting_middleware", "line": 131, "message": "request_complete - method=GET, path=/api/metrics/user, status=500, duration_ms=621.06, trace_id=54ef5286-3bac-42da-8006-b426875ad631", "trace_id": "54ef5286-3bac-42da-8006-b426875ad631", "request_id": "9aaf2819-5e34-4c86-be91-e6f77a55304a", "user_id_hash": "c55ea77e83770883"}
{"timestamp": "2026-01-12T18:20:07.969776Z", "level": "INFO", "logger": "app_logger", "module": "main", "function": "shutdown_event", "line": 287, "message": "app_shutdown - saving all active chats", "trace_id": null, "request_id": null, "user_id_hash": null}
